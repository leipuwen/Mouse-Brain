<!DOCTYPE html>
<html class='no-js' lang='en'>

<head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>Mouse VizAnalytic</title>
    <meta content='Rai' name='author'>
    <meta content='' name='description'>
    <meta content='' name='keywords'>
    <link href="assets/stylesheets/application-a07755f5.css" rel="stylesheet" type="text/css" />
    <link href="assets/stylesheets/css.css" rel="stylesheet" type="text/css" />
    <link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/images/favicon.ico" rel="icon" type="image/ico" />

    <!-- Javascripts -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js" type="text/javascript"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js" type="text/javascript"></script>
    <script src="https://cdn.bootcss.com/three.js/92/three.js"></script>
    <script src="assets/javascripts/application.js" type="text/javascript"></script>
    <script src="assets/javascripts/STLLoader.js" type="text/javascript"></script>
    <script src="assets/javascripts/Detector.js" type="text/javascript"></script>
    <script src="assets/javascripts/OrbitControls.js" type="text/javascript"></script>
    <script src="assets/javascripts/stat.min.js" type="text/javascript"></script>
    <script src="assets/javascripts/TransformControls.js" type="text/javascript"></script>
    <script src="assets/javascripts/plotly-latest.min.js" type="text/javascript"></script>
    <!-- <script src="https://d3js.org/d3.v5.min.js"></script> -->
    <script src="https://d3js.org/d3.v4.min.js"></script>


</head>

<body class='main page'>
    <!-- Navbar -->
    <div class='navbar navbar-default' id='navbar'>
        <a class='navbar-brand' href='#'>
        <i class='icon-beer'></i>
        Mouse's Brain VizSystem
      </a>
        <ul class='nav navbar-nav pull-right'>
            <li class='dropdown'>
                <a class='dropdown-toggle' data-toggle='dropdown' href='#'>
            <i class='icon-envelope'></i>
            Messages
            <span class='badge'>99+</span>
            <b class='caret'></b>
          </a>
                <ul class='dropdown-menu'>
                    <li>
                        <a href='#'>New message</a>
                    </li>
                    <li>
                        <a href='#'>Inbox</a>
                    </li>
                    <li>
                        <a href='#'>Out box</a>
                    </li>
                    <li>
                        <a href='#'>Trash</a>
                    </li>
                </ul>
            </li>
            <li>
                <a href='#'>
            <i class='icon-cog'></i>
            Settings
          </a>
            </li>
        </ul>
    </div>
    <div id='wrapper'>
        <!-- Sidebar -->
        <section id='sidebar'>
            <i class='icon-align-justify icon-large' id='toggle'></i>
            <ul id='dock'>
                <li class='active launcher'>
                    <i class='icon-dashboard'></i>
                    <a href="dashboard.html">Dashboard</a>
                </li>
                <li class='launcher'>
                    <i class='icon-file-text-alt'></i>
                    <a href="forms.html">Forms</a>
                </li>
                <li class='launcher'>
                    <i class='icon-table'></i>
                    <a href="tables.html">Tables</a>
                </li>
                <li class='launcher dropdown hover'>
                    <i class='icon-flag'></i>
                    <a href='#'>Reports</a>
                    <ul class='dropdown-menu'>
                        <li class='dropdown-header'>Analytic 1</li>
                        <li>
                            <a href='#'>Analytic 2</a>
                        </li>
                        <li>
                            <a href='#'>Analytic 3</a>
                        </li>
                        <li>
                            <a href='#'>Analytic 4</a>
                        </li>
                    </ul>
                </li>
                <li class='launcher'>
                    <i class='icon-bookmark'></i>
                    <a href='#'>Marks</a>
                </li>
                <li class='launcher'>
                    <i class='icon-cloud'></i>
                    <a href='#'>Backup</a>
                </li>
                <li class='launcher'>
                    <i class='icon-bug'></i>
                    <a href='#'>Bug</a>
                </li>
            </ul>
            <div data-toggle='tooltip' id='beaker' title='Powered by Rai'></div>
        </section>
        <!-- Tools -->
        <section id='tools'>
            <ul class='breadcrumb' id='breadcrumb'>
                <li class='title'>Dashboard</li>
            </ul>
            <div id='toolbar'>
                <div class='btn-group'>
                    <a class='btn' data-toggle='toolbar-tooltip' href='#' title='Building'>
              <i class='icon-building'></i>
            </a>
                    <a class='btn' data-toggle='toolbar-tooltip' href='#' title='Laptop'>
              <i class='icon-laptop'></i>
            </a>
                    <a class='btn' data-toggle='toolbar-tooltip' href='#' title='Lemon'>
              <i class='icon-lemon'></i>
            </a>
                </div>
            </div>
        </section>
        <!-- Content -->
        <div id='content'>
            <div id='brain' class='panel panel-default'>
                <div class='panel-heading'>
                    <i class='icon-star icon-large'></i> 3D Model of Mouse's Brain
                    <div class='panel-tools'>
                        <div class='btn-group'>
                            <a class='btn' href='#'>
                  <i class='icon-refresh'></i>
                  Refresh statics
                </a>
                        </div>
                    </div>
                </div>
                <div class='panel-body'>
                    <div id='brain3D'></div>
                </div>
            </div>

            <div id='graph1' class='panel panel-default'>
                <div class='panel-heading'>
                    <i class='icon-star icon-large'></i> Brain's Network
                    <div class='panel-tools'>
                        <div class='btn-group'>
                            <a class='btn' href='#'>
                  <i class='icon-refresh'></i>
                  Refresh statics
                </a>
                        </div>
                    </div>
                </div>
                <div class='panel-body'>
                    <svg id='network' width="880" height="500"></svg>
                </div>
            </div>

            <div id='slice' class='panel panel-default'>
                <div class='panel-heading'>
                    <i class='icon-star icon-large'></i> Brain's Slice
                    <div class='panel-tools'>
                        <div class='btn-group'>
                            <a class='btn' href='#'>
                  <i class='icon-refresh'></i>
                  Refresh statics
                </a>
                        </div>
                    </div>
                </div>
                <div class='panel-body'>
                    <div id='sliceGraph'></div>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->

</body>

</html>

<script>
    var brain, camera, scene, renderer;
    var params = {
        clipIntersection: true,
        planeConstant: 0,
        showHelpers: true
    };
    var clipPlanes = [
        new THREE.Plane(new THREE.Vector3(0, 1, 0), 0),
        new THREE.Plane(new THREE.Vector3(1, 0, 0), 0),
        new THREE.Plane(new THREE.Vector3(0, 0, 1), 0)
    ];


    init();
    animate();

    function init() {
        brain = document.getElementById('brain3D');

        // renderer

        renderer = new THREE.WebGLRenderer({
            antialias: true
        });

        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.localClippingEnabled = true;
        renderer.setSize(0.432 * window.innerWidth, 0.362 * window.innerHeight);
        brain.appendChild(renderer.domElement);

        // scene

        scene = new THREE.Scene();

        // camera

        camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 1, 10000);
        camera.position.set(0, 15, -15);
        var controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.addEventListener('change', render); // use only if there is no animation loop
        controls.minDistance = 10;
        controls.maxDistance = 100;
        controls.enablePan = false;

        scene.add(camera); // required, because we are adding a light as a child of the camera

        // lights

        scene.add(new THREE.AmbientLight(0x222222));

        var light = new THREE.PointLight(0xffffff, 0.8);
        camera.add(light);

        // helpers
        var helpers = new THREE.Group();
        helpers.add(new THREE.AxesHelper(20));
        helpers.add(new THREE.PlaneHelper(clipPlanes[0], 30, 0x00ff00));
        helpers.add(new THREE.PlaneHelper(clipPlanes[1], 30, 0xff0000));
        helpers.add(new THREE.PlaneHelper(clipPlanes[2], 30, 0x0000ff));
        helpers.visible = true;
        scene.add(helpers);

        // object

        var loader = new THREE.STLLoader();
        loader.load('static/model/brain.stl', function(geometry) {

            var material = new THREE.MeshPhongMaterial({
                color: 0xff5533
            });
            geometry.center()Â 

            var mesh = new THREE.Mesh(geometry, material);

            control = new THREE.TransformControls(camera, renderer.domElement);
            control.addEventListener('change', render);
            control.addEventListener('dragging-changed', function(event) {
                controls.enabled = !event.value;
            });
            control.setMode("translate");

            scene.add(mesh);
            control.attach(helpers.children[2]);
            scene.add(control);

        });


        stats = new Stats();
        brain.appendChild(stats.dom);

        window.addEventListener('resize', onWindowResize, false);

    }

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;

        camera.updateProjectionMatrix();

        renderer.setSize(1130, 510);

    }


    function animate() {

        requestAnimationFrame(animate);
        render();
        stats.update();

    }
    console.log(scene.children[2].children[2]);

    function render() {

        var timer = Date.now() * 0.0005;
        // camera.position.x = Math.cos(timer) * 3;
        // camera.position.z = Math.sin(timer) * 3;
        camera.lookAt(scene.position);
        renderer.setSize(0.435 * window.innerWidth, 0.362 * window.innerHeight);
        renderer.render(scene, camera);

    }
</script>

<script>
    var trace1 = {
        x: [],
        y: [],
        mode: 'markers+lines',
        type: 'scatter',
        name: 'Group A',
        // text: ['A-1', 'A-2', 'A-3', 'A-4', 'A-5'],
        textposition: 'top center',
        textfont: {
            family: 'Raleway, sans-serif'
        },
        marker: {
            size: 12
        }
    };

    var trace2 = {
        x: [],
        y: [],
        mode: 'markers+lines',
        type: 'scatter',
        name: 'Group B',
        // text: ['B-a', 'B-b', 'B-c', 'B-d', 'B-e'],
        textfont: {
            family: 'Raleway, sans-serif'
        },
        textposition: 'top center',
        marker: {
            size: 12
        }
    };

    var trace3 = {
        x: [],
        y: [],
        mode: 'markers+lines',
        type: 'scatter',
        name: 'Group C',
        // text: ['A-1', 'A-2', 'A-3', 'A-4', 'A-5'],
        textposition: 'top center',
        textfont: {
            family: 'Raleway, sans-serif'
        },
        marker: {
            size: 12
        }
    };

    var trace4 = {
        x: [],
        y: [],
        mode: 'markers+lines',
        type: 'scatter',
        name: 'Group D',
        // text: ['A-1', 'A-2', 'A-3', 'A-4', 'A-5'],
        textposition: 'top center',
        textfont: {
            family: 'Raleway, sans-serif'
        },
        marker: {
            size: 12
        }
    };

    var trace5 = {
        x: [],
        y: [],
        mode: 'markers+lines',
        type: 'scatter',
        name: 'Group E',
        // text: ['A-1', 'A-2', 'A-3', 'A-4', 'A-5'],
        textposition: 'top center',
        textfont: {
            family: 'Raleway, sans-serif'
        },
        marker: {
            size: 12
        }
    };
    for (var i = 0; i < 15; i++) {
        trace1.x[i] = 10 * Math.random();
        trace1.y[i] = 10 * Math.random();
        trace2.x[i] = 10 * Math.random();
        trace2.y[i] = 10 * Math.random();
        trace3.x[i] = 10 * Math.random();
        trace3.y[i] = 10 * Math.random();
        trace4.x[i] = 10 * Math.random();
        trace4.y[i] = 10 * Math.random();
        trace5.x[i] = 10 * Math.random();
        trace5.y[i] = 10 * Math.random();
    }
    var data = [trace1, trace2, trace3, trace4, trace5];


    var layout = {
        autosize: true,
        images: [{
            "source": "static/images/photo2.jpg",
            "xref": "x",
            "yref": "y",
            "x": 0,
            "y": 10,
            "sizex": 10,
            "sizey": 10,
            "sizing": "stretch",
            "opacity": 1,
            "layer": "below"

        }],
        margin: {
            r: 10,
            t: 20,
            b: 0,
            l: 10
        },
        xaxis: {
            autotick: false,
            showgrid: true,
            gridwidth: 1,
            showticklabels: false,
        },
        yaxis: {
            autotick: false,
            gridwidth: 1,
            showgrid: true,
            showticklabels: false,
        }
    };

    Plotly.plot('sliceGraph', data, layout);
</script>

<script>
    var svg = d3.select('#network'),
        width = +svg.attr("width"),
        height = +svg.attr("height");

    var color = d3.scaleOrdinal(d3.schemeCategory20);

    var simulation = d3.forceSimulation()
        .force("link", d3.forceLink().id(function(d) {
            return d.id;
        }))
        .force("charge", d3.forceManyBody())
        .force("center", d3.forceCenter(width / 2, height / 2));

    d3.json("static/data/miserables.json", function(error, graph) {
        if (error) throw error;

        var link = svg.append("g")
            .attr("class", "links")
            .selectAll("line")
            .data(graph.links)
            .enter().append("line")
            .attr("stroke-width", function(d) {
                return Math.sqrt(d.value);
            });

        var node = svg.append("g")
            .attr("class", "nodes")
            .selectAll("circle")
            .data(graph.nodes)
            .enter().append("circle")
            .attr("r", 5)
            .attr("fill", function(d) {
                return color(d.group);
            })
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        node.append("title")
            .text(function(d) {
                return d.id;
            });

        simulation
            .nodes(graph.nodes)
            .on("tick", ticked);

        simulation.force("link")
            .links(graph.links);

        function ticked() {
            link
                .attr("x1", function(d) {
                    return d.source.x;
                })
                .attr("y1", function(d) {
                    return d.source.y;
                })
                .attr("x2", function(d) {
                    return d.target.x;
                })
                .attr("y2", function(d) {
                    return d.target.y;
                });

            node
                .attr("cx", function(d) {
                    return d.x;
                })
                .attr("cy", function(d) {
                    return d.y;
                });
        }
    });

    function dragstarted(d) {
        if (!d3.event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
</script>
